<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contentful Test - VendSmart</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-result { margin: 10px 0; padding: 10px; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 3px; overflow-x: auto; }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/contentful@latest/dist/contentful.browser.min.js"></script>
</head>
<body>
    <h1>Contentful Integration Test</h1>
    <div id="testResults"></div>

    <script>
        const results = document.getElementById('testResults');
        
        function addResult(type, message, data = null) {
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.innerHTML = `<strong>${message}</strong>`;
            if (data) {
                div.innerHTML += `<pre>${JSON.stringify(data, null, 2)}</pre>`;
            }
            results.appendChild(div);
        }

        async function runTests() {
            addResult('info', 'Starting Contentful integration tests...');

            // Test 1: Check if Contentful SDK is loaded
            if (typeof contentful === 'undefined') {
                addResult('error', '❌ Contentful SDK not loaded');
                return;
            }
            addResult('success', '✅ Contentful SDK loaded successfully');

            // Test 2: Initialize client
            try {
                const client = contentful.createClient({
                    space: 'xpopyri6s8gv',
                    accessToken: 'u7y4yBwgXnAUXt-c2B4rVuidEoe4L3AzMBzkNMxSXp0'
                });
                addResult('success', '✅ Contentful client initialized');
            } catch (error) {
                addResult('error', '❌ Failed to initialize Contentful client', error);
                return;
            }

            // Test 3: Test connection and fetch content types
            try {
                const client = contentful.createClient({
                    space: 'xpopyri6s8gv',
                    accessToken: 'u7y4yBwgXnAUXt-c2B4rVuidEoe4L3AzMBzkNMxSXp0'
                });

                const contentTypes = await client.getContentTypes();
                addResult('success', `✅ Connected to Contentful successfully. Found ${contentTypes.items.length} content types`);
                addResult('info', 'Available content types:', contentTypes.items.map(ct => ct.name));

                // Test 4: Try to fetch blog posts
                try {
                    const posts = await client.getEntries({
                        content_type: 'blogPost',
                        limit: 5
                    });
                    addResult('success', `✅ Found ${posts.items.length} blog posts`);
                    
                    if (posts.items.length > 0) {
                        const firstPost = posts.items[0];
                        addResult('info', 'First post details:', {
                            title: firstPost.fields.title,
                            category: firstPost.fields.category,
                            id: firstPost.sys.id,
                            availableFields: Object.keys(firstPost.fields)
                        });
                    }
                } catch (postError) {
                    addResult('error', '❌ Failed to fetch blog posts', postError);
                    
                    // Try alternative content type names
                    try {
                        const postsAlt = await client.getEntries({
                            content_type: 'post',
                            limit: 5
                        });
                        addResult('success', `✅ Found ${postsAlt.items.length} posts with content type 'post'`);
                    } catch (altError) {
                        addResult('error', '❌ Also failed with content type "post"', altError);
                    }
                }

            } catch (error) {
                addResult('error', '❌ Failed to connect to Contentful', error);
            }
        }

        // Run tests when page loads
        document.addEventListener('DOMContentLoaded', runTests);
    </script>
</body>
</html> 